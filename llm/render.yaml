# Render configuration for LawStreet LLM Service
# Memory optimized for free tier (512MB)

services:
  - type: web
    name: lawstreet-llm
    runtime: python
    region: oregon  # or your preferred region
    plan: free
    rootDir: llm
    buildCommand: chmod +x build.sh && ./build.sh
    startCommand: gunicorn -c gunicorn.conf.py app.main:app
    envVars:
      - key: PYTHON_VERSION
        value: "3.11"
      - key: WEB_CONCURRENCY
        value: "1"  # CRITICAL: Only 1 worker for 512MB memory
      - key: LLM_PROVIDER
        value: middleware
      - key: GEMINI_API_KEY
        sync: false  # Set in Render dashboard
      - key: LLM_MIDDLEWARE_URL
        sync: false
      - key: LLM_MIDDLEWARE_SECRET
        sync: false
      - key: TAVILY_API_KEY
        sync: false
    healthCheckPath: /health
